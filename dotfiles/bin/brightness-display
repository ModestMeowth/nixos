#!/usr/bin/env bash
set -x

step="${1:-+5%}"

device="$(ls -1 /sys/class/backlight 2>/dev/null | head -n1)"
for candidate in amdgpu_bl* intel_backlight acpi_video*; do
    if [[ -e "/sys/class/backlight/$candidate" ]]; then
        device="$candidate"
        break
    fi
done

brightnessctl -d "$device" set "$step" >/dev/null
swayosd-brightness "$(brightnessctl -d "$device" -m | cut -d',' -f4 | tr -d '%')"
